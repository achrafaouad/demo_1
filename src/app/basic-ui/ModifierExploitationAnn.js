import React from 'react';
import moment from 'moment';
import { Modal, version, Button } from 'antd';
import 'antd/dist/antd.css';
import ToggleButton from 'react-bootstrap/ToggleButton';
import ButtonGroup from 'react-bootstrap/ButtonGroup';
import InputGroup from 'react-bootstrap/InputGroup';
import FormControl from 'react-bootstrap/FormControl';
import { Select } from 'antd';
import { Input } from 'antd';
import { Radio ,DatePicker } from 'antd';
import { Slider, Switch } from 'antd';
import { ToastContainer, toast } from 'react-toastify';
import 'react-toastify/dist/ReactToastify.css';

toast.configure();

const options = [
  { label: 'Ovins', value: 'Ovins' },
  { label: 'Bovin', value: 'Bovin' },
  { label: 'Volaille', value: 'Volaille' },
];

const { Option } = Select;

const gender = [ 
  { label: 'oui', value: "true" },
  { label: 'non', value: "false" }
];
const { TextArea } = Input;

class ModifierExpAnn extends React.Component {
  constructor(props){
    super(props);
    if(this.props.expl){
        var {errige,source_eau,type,batiment,id_exploitation,culture_permanent,note,date_exploitation,nom,type_source_eau,distance_eau,vulnérable,certification,zone_spécifique,système_irrigation}=this.props.expl;
        this.state = {nom:nom,type:type,batiment:String(batiment),errige:String(errige),id_exploitation:id_exploitation,source_eau:String(source_eau),culture_permanent:String(culture_permanent),note:note,date_exploitation:date_exploitation,type_source_eau:type_source_eau,distance_eau:distance_eau,vulnérable:String(vulnérable),certification:certification,zone_spécifique:zone_spécifique,système_irrigation:système_irrigation}
        console.log("hakhona",this.props.expl)
        console.log(this.state)
        
    }
    this.handleOk=this.handleOk.bind(this);
    this.handleCancel=this.handleCancel.bind(this);
    this.showModal=this.showModal.bind(this);
    this.handlechange=this.handlechange.bind(this);
    this.select_spécifique=this.select_spécifique.bind(this);
    this.select_certification=this.select_certification.bind(this);
   
    this.onChange_date_Exploitation=this.onChange_date_Exploitation.bind(this);
    

    
  }


  select_certification(value) {
    console.log(`selected ${value}`);
    this.setState({certification:value})
  }
  select_spécifique(value) {
    console.log(`selected ${value}`);
    this.setState({zone_spécifique:value})
  }
 
  showModal = () => {
    this.setState({
      visible: true,
    });
  }
  
  
  
  
  handleOk = (e) => {
    
    
      fetch("http://localhost:3001/update_exploitationAnn",{
      method:'POST',
      headers:{'Content-Type':"application/json"},
      body:JSON.stringify({
            nom:this.state.nom,
            date_exploitation:this.state.date_exploitation,
            batiment:this.state.batiment,
            note:this.state.note,
            type:this.state.type,
            id_exploitation:this.state.id_exploitation
      })
 }).then(response =>{
   if(response.ok){
     return response.json();
   }
   throw new Error('request failed');}, networkError => console.log(networkError))
   .then(responseJson =>{
     console.log(responseJson)
     toast.success('Les informations sur l\'exploitation ont été mises à jour avec success.' ,{position:toast.POSITION.TOP_RIGHT , autoClose:8000});
     this.props.retour()
   })
      
     
    this.setState({
      visible: false,
    });
  }
  
  handleCancel = (e) => {
    console.log(e);
    this.setState({
      visible: false,
    });
  }
 

  handlechange({target}){
    console.log("ello",target.value);
    this.setState({
      [target.name]: target.value
    });
    console.log(this.state);
  } 

  

  onChange_date_Exploitation(date,dateString) {
    console.log(date,dateString);
    this.setState({"date_exploitation":dateString})
  }


  render() {
   
      console.log("ha state",this.state)
    const {  value3 } = this.state;
    console.log('props', this.props)
    console.log(this.props.last_feature)
    return (
      <div>
        <button type="button"  class="btn btn-warning btn-lg btn-block" onClick={this.showModal}>Modifier</button>

        <Modal
          title="Modifier les information de votre production"
          visible={this.state.visible}
          onOk={this.handleOk}
          onCancel={this.handleCancel}
        >
          
        
        <p>Nom</p>
       
          <InputGroup className="mb-3">
          <FormControl
            placeholder="race de votre animal"
            name="nom"
            value={this.state.nom}
            aria-label="Recipient's username"
            aria-describedby="basic-addon2"
            onChange={this.handlechange}
          />
          
        </InputGroup>
        
  <p>Date d'exploitation</p>
    <DatePicker onChange={this.onChange_date_Exploitation}/>

    <p>Batiment</p>
    <Radio.Group
          options={gender}
          name="batiment"
          onChange={this.handlechange}
          value={this.state.batiment}
          optionType="button"
          buttonStyle="solid"
        />

     <p>Est constituée des?</p>
        <Radio.Group
          name="type"
          options={options}
          onChange={this.handlechange}
          value={this.state.type}
          optionType="button"
          buttonStyle="solid"
        />

    <p>Note</p>
    <TextArea rows={2} name="note" value={this.state.note} onChange={this.handlechange} />


        </Modal>
      </div>
    );
  }
}


export default ModifierExpAnn